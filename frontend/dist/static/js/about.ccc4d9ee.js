(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about"],{"36d0":function(e,t,n){e.exports=n.p+"static/img/30.bcfbb752.jpg"},"4f92":function(e,t,n){},5118:function(e,t,n){(function(e){var o="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function s(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new s(a.call(setTimeout,o,arguments),clearTimeout)},t.setInterval=function(){return new s(a.call(setInterval,o,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(o,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n("c8ba"))},"555a":function(e,t,n){e.exports=n.p+"static/img/icon.37c317ad.png"},6017:function(e,t,n){(function(e,t){(function(e,n){"use strict";if(!e.setImmediate){var o,a=1,s={},i=!1,r=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?p():f()?g():e.MessageChannel?m():r&&"onreadystatechange"in r.createElement("script")?y():b(),c.setImmediate=l,c.clearImmediate=u}function l(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return s[a]=i,o(a),a++}function u(e){delete s[e]}function d(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(n,o);break}}function h(e){if(i)setTimeout(h,0,e);else{var t=s[e];if(t){i=!0;try{d(t)}finally{u(e),i=!1}}}}function p(){o=function(e){t.nextTick(function(){h(e)})}}function f(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function g(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&h(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),o=function(n){e.postMessage(t+n,"*")}}function m(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;h(t)},o=function(t){e.port2.postMessage(t)}}function y(){var e=r.documentElement;o=function(t){var n=r.createElement("script");n.onreadystatechange=function(){h(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function b(){o=function(e){setTimeout(h,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,n("c8ba"),n("4362"))},6027:function(e,t,n){"use strict";var o=n("4f92"),a=n.n(o);a.a},"88db":function(e,t,n){e.exports=n.p+"static/img/100.0ee31766.jpg"},a1e2:function(e,t,n){e.exports=n.p+"static/img/60.cc3ab354.jpg"},f820:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"layout"},[o("Layout",{staticStyle:{height:"100%"}},[o("Sider",{style:{color:"#fff"},attrs:{breakpoint:"md","collapsed-width":78,width:250}},[o("div",{staticClass:"mt3"},[o("h1",[e._v(e._s(e._f("formatUserName")(e.username)))]),o("h3",{staticClass:"mt1"},[e._v(e._s(e.department))])]),o("br"),o("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"space-around",align:"middle"}},[o("p",{staticClass:"money"},[e._v("余额:"+e._s(e.money)+"元")]),o("a",{staticClass:"ref",attrs:{href:"javascript:void(0)"},on:{click:e.Refresh}},[e._v("刷新")])]),o("br"),o("Tooltip",{attrs:{content:"订饭时间为早上 08:30--9:30",placement:"top",theme:"light"}},[o("Button",{staticStyle:{width:"200px"},attrs:{type:"primary",disabled:e.isPay,loading:e.butloading},on:{click:e.lunch}},[e._v("订饭")])],1),o("br"),o("br"),o("Tooltip",{attrs:{content:"扫码充值金额，需与页面选择一致",placement:"bottom",theme:"light"}},[o("Button",{staticStyle:{width:"200px"},attrs:{disabled:e.rechaege,loading:e.butloading},on:{click:e.give_money}},[e._v("充值")])],1),o("br"),o("br"),o("br"),o("Button",{staticStyle:{width:"200px",border:"none"},attrs:{type:"default",ghost:""},on:{click:e.change_psw}},[e._v("修改密码")]),o("Footer",{staticClass:"layout-footer-center"},[e._v("v1.0")])],1),o("Layout",[o("Header",{staticClass:"layout-header-bar"},[o("div",{staticStyle:{"font-size":"17px","font-weight":"600"}},[o("img",{attrs:{src:n("555a"),alt:"",width:"1.4%"}}),e._v("\n          温馨提示：订饭时间为工作日早上 08:30--09:30，充值时间为周一、周三早上08:30--09:30\n          "),o("a",{staticClass:"outcss",staticStyle:{float:"right","font-size":"14px","font-weight":"400"},attrs:{href:"javascript:void(0)"},on:{click:e.loginout}},[e._v("注销")])])]),o("Content",{style:{margin:"20px",minHeight:"220px"}},[o("Tabs",{staticStyle:{"background-color":"#fff","box-shadow":"0 1px 1px rgba(0, 0, 0, 0.1)","padding-bottom":"30px"},attrs:{value:e.name}},[o("TabPane",{attrs:{label:"最近10次订饭记录",icon:"ios-list-box-outline",name:"lunch"}},[o("Table",{staticStyle:{margin:"20px"},attrs:{loading:e.loading,data:e.order,columns:e.orderColumns,stripe:""}})],1),o("TabPane",{attrs:{label:"最近10次充值记录",icon:"ios-list-box-outline",name:"price"}},[o("Table",{staticStyle:{margin:"20px"},attrs:{loading:e.loading,data:e.tabledata1,columns:e.tableColumns,stripe:""}})],1)],1)],1)],1)],1),o("Modal",{attrs:{title:"修改密码","mask-closable":!1,closable:!1},model:{value:e.show_psw,callback:function(t){e.show_psw=t},expression:"show_psw"}},[o("Input",{staticClass:"mt2",attrs:{type:"password",password:"",placeholder:"请输入原密码..."},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.change_pswok(t)}},model:{value:e.oldpsw,callback:function(t){e.oldpsw=t},expression:"oldpsw"}}),o("Input",{staticClass:"mt2",attrs:{type:"password",password:"",placeholder:"请输入新密码..."},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.change_pswok(t)}},model:{value:e.psw,callback:function(t){e.psw=t},expression:"psw"}}),o("Input",{staticClass:"mt2",attrs:{type:"password",password:"",placeholder:"请确认新密码..."},nativeOn:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.change_pswok(t)}},model:{value:e.psw2,callback:function(t){e.psw2=t},expression:"psw2"}}),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{on:{click:e.cancel}},[e._v("取消")]),o("Button",{attrs:{type:"primary"},on:{click:e.change_pswok}},[e._v("修改")])],1)],1),o("Modal",{attrs:{title:"订饭",closable:!1},model:{value:e.show_lunch,callback:function(t){e.show_lunch=t},expression:"show_lunch"}},[o("RadioGroup",{style:{margin:"20px",minHeight:"120px"},attrs:{size:"large"},model:{value:e.choselunch,callback:function(t){e.choselunch=t},expression:"choselunch"}},[e._l(e.lunchlist,function(e){return o("Radio",{key:e.value,attrs:{label:e.label}})}),o("br"),o("br"),o("p",{staticClass:"mt1"},[e._v("数量："+e._s(e.count))])],2),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{on:{click:e.cancel_lunch}},[e._v("取消")]),o("Button",{attrs:{type:"primary",loading:e.lunchloading},on:{click:function(t){return e.give_lunchok()}}},[e._v("订饭")])],1)],1),o("Modal",{attrs:{title:"微信扫码充值","mask-closable":!1,closable:!1},model:{value:e.show_money,callback:function(t){e.show_money=t},expression:"show_money"}},[o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{on:{click:e.cancelmoney}},[e._v("取消")]),o("Button",{attrs:{type:"primary",loading:e.priceloading},on:{click:e.give_moneyok}},[e._v("充值")])],1),o("p",{staticClass:"mb1",staticStyle:{"font-size":"14px"}},[e._v("请选择充值金额：")]),o("Select",{attrs:{size:"large"},on:{"on-change":e.moneypic},model:{value:e.model1,callback:function(t){e.model1=t},expression:"model1"}},e._l(e.priceList,function(t,n){return o("Option",{key:n,attrs:{value:t.value}},[e._v(e._s(t.label))])}),1),o("p",{staticClass:"mt1",staticStyle:{color:"red"}},[e._v("扫码充值金额，需与页面选择一致，请自觉遵守，否则无效")]),o("p",{staticClass:"mt1",staticStyle:{color:"#2f8bf0"}},[e._v("打开微信扫码充值，需在赞赏备注里留言英文名")]),o("br"),o("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"center",align:"middle"}},[o("img",{attrs:{src:e.imgurl,alt:"",width:"60%"}})])],1)],1)},a=[],s=n("7618"),i=n("e814"),r=n.n(i),c=n("cebc"),l=n("bd86"),u=(n("bc3a"),n("5118")),d=n("fa7d"),h={data:function(){var e,t=this;return e={imgurl:n("36d0"),username:"",department:"工程部",money:"",bought:2,integral:500,tabledata1:[],order:[],butloading:!0,name:"lunch",orderColumns:[{key:"index",title:"订单编号"},{title:"用户名",key:"user"},{title:"餐费",key:"price"},{title:"订单时间",key:"created",render:function(e,t){return e("span",Object(d["a"])(t.row.created))}},{title:"订单状态",key:"is_finished",render:function(e,t){var n=t.row;if(-1===n.is_finished)return e("Poptip",{props:{trigger:"hover",title:"失败原因可能",content:"超过订饭时间",placement:"right"}},[e("Tag",{props:{type:"dot",color:"error"}},["订饭失败",e("Icon",{style:{marginLeft:"3px",position:"relative",right:"-3px",top:"-5px"},props:{type:"ios-help-circle-outline",color:"#c1c4ca"}})])]);var o=1===n.is_finished?"success":"warning",a=1===n.is_finished?"订饭成功":"等待确认";return e("Tag",{props:{type:"dot",color:o}},a)}}],loading:!0},Object(l["a"])(e,"tabledata1",[]),Object(l["a"])(e,"errorlist",[{errorconect:"充值金额不匹配"},{errorconect:"充值时间不匹配"},{errorconect:"未收到充值金额"}]),Object(l["a"])(e,"tableColumns",[{title:"充值编号",key:"index"},{title:"用户名",key:"user"},{title:"充值金额",key:"amount"},{title:"充值日期",key:"modified",render:function(e,t){return e("span",Object(d["a"])(t.row.modified))}},{title:"充值状态",key:"is_finished",render:function(e,n){var o=n.row;if(-1===o.is_finished)return e("Poptip",{props:{trigger:"hover",title:"失败原因可能",placement:"right"}},[e("Tag",{props:{type:"dot",color:"error",icon:"ios-help-circle-outline"}},["充值失败",e("Icon",{style:{marginLeft:"3px",position:"relative",right:"-3px",top:"-5px"},props:{type:"ios-help-circle-outline",color:"#c1c4ca"}})]),e("div",{slot:"content"},[e("ul",t.errorlist.map(function(t){return e("li",{style:{textAlign:"left",padding:"4px"}},t.errorconect)}))])]);var a=1===o.is_finished?"success":"warning",s=1===o.is_finished?"充值成功":"等待确认";return e("Tag",{props:{type:"dot",color:a}},s)}}]),Object(l["a"])(e,"lunchloading",!1),Object(l["a"])(e,"priceloading",!1),Object(l["a"])(e,"show_psw",!1),Object(l["a"])(e,"show_money",!1),Object(l["a"])(e,"show_lunch",!1),Object(l["a"])(e,"oldpsw",""),Object(l["a"])(e,"psw",""),Object(l["a"])(e,"psw2",""),Object(l["a"])(e,"choselunch","10元套餐(一荤三素)"),Object(l["a"])(e,"priceList",[{value:30,label:30},{value:60,label:60},{label:100,value:100}]),Object(l["a"])(e,"model1",30),Object(l["a"])(e,"count",1),Object(l["a"])(e,"isPay",!0),Object(l["a"])(e,"rechaege",!0),Object(l["a"])(e,"lunchlist",[{label:"10元套餐(一荤三素)",value:10},{label:"12元套餐(两荤三素)",value:12}]),e},created:function(){this.getdata(),this.checkIsPay(),this.checkorder()},methods:{checkIsPay:function(){var e=this;this.$ajax("get","/order/button?button=order").then(function(t){t.data.order?e.isPay=!1:e.isPay=!0,e.butloading=!1}).catch(function(e){console.log(e)})},checkorder:function(){var e=this;this.$ajax("get","/order/button?button=recharge").then(function(t){t.data.recharge?(e.rechaege=!1,console.log(t.data.recharge)):e.rechaege=!0,e.butloading=!1}).catch(function(e){console.log(e)})},getdata:function(){var e=JSON.parse(d["b"].getStore("userInfo"));return this.username=e.username,this.getmoney(),this.getrecharge(),this.getlunchorder(),!0},getmoney:function(){var e=this;this.$ajax("get","/recharge/money/").then(function(t){console.log(t.data),e.money=t.data.money}).catch(function(t){console.log(t),e.$Message.error("请求错误，请稍后重试")})},getlunchorder:function(){var e=this;this.$ajax("get","/order/order/").then(function(t){t.data&&(e.loading=!1,e.order=t.data.map(function(e,n){return Object(c["a"])({index:-1*(n-t.data.length)},e)}))}).catch(function(t){return e.$Message.error("请求错误，请稍后重试"),!1})},getrecharge:function(){var e=this;this.$ajax("get","/recharge/recharge/").then(function(t){t.data&&t.data.length&&(d["b"].setStore("userInfo",{username:t.data[0].user}),e.username=t.data[0].user,e.tabledata1=t.data.map(function(e,n){return Object(c["a"])({index:-1*(n-t.data.length)},e)})),e.loading=!1}).catch(function(t){console.log(t),e.$Message.error("请求错误，请稍后重试")})},loginout:function(){d["b"].removeStore("userInfo"),this.$router.push({name:"home"})},Refresh:function(){this.getmoney(),this.getrecharge(),this.getlunchorder(),this.$Message.success("刷新成功")},lunch:function(){this.show_lunch=!0},cancel_lunch:function(){this.lunchloading=!1,this.show_lunch=!1},checkprice:function(){var e=this.money,t=!0;return e<10||e<12?(t=!1,this.lunchloading=!1,this.$Message.error("不好意思，余额不足，请充值")):this.isPay&&(t=!1,this.$Message.error("不能订饭了，明天再来吧")),t},give_lunchok:function(){var e=this;if(this.lunchloading=!0,this.checkprice()){var t=r()(this.choselunch.substring(0,2));this.$ajax("post","/order/order/",{price:t,number:this.count}).then(function(t){"Order successfully , wait result"==t.data.msg&&(e.name="lunch",e.show_lunch=!1,e.$Message.success({content:"订饭成功，管理员会尽快确认",duration:5}),e.getlunchorder(),e.lunchloading=!1)}).catch(function(t){t&&"Have unfinished order"==t.data.msg?(e.$Message.error("一天只能订一次饭，明天再来吧"),e.lunchloading=!1):(e.$Message.error("请求错误，请稍后重试"),e.lunchloading=!1),e.show_lunch=!0})}},give_money:function(){this.show_money=!0,console.log(Object(s["a"])(this.money))},cancelmoney:function(){this.model1=30,this.imgurl=n("36d0"),this.show_money=!1},moneypic:function(e){30===e?this.imgurl=n("36d0"):60===e?this.imgurl=n("a1e2"):100===e&&(this.imgurl=n("88db"))},give_moneyok:function(){var e=this;this.priceloading=!0,this.$ajax("post","/recharge/recharge/",{amount:this.model1}).then(function(t){"Recharge successfully , wait result"===t.data.msg&&(e.name="price",e.priceloading=!1,e.$Message.success({content:"充值成功，管理员会尽快确认",duration:5}),e.model1=30,e.imgurl=n("36d0"),e.getrecharge(),e.show_money=!1)}).catch(function(t){console.log(t),e.$Message.error("请求错误，请稍后重试"),e.model1=30,e.show_money=!0})},change_psw:function(){this.show_psw=!0},checkForm:function(){var e=!0;return this.oldpsw?this.psw?this.oldpsw==this.psw?(e=!1,this.show_psw=!0,this.$Message.warning("新密码和旧密码一致")):this.psw!==this.psw2&&(e=!1,this.show_psw=!0,this.$Message.warning("两次密码不一致，请核对")):(e=!1,this.show_psw=!0,this.$Message.warning("请输入新密码")):(e=!1,this.show_psw=!0,this.$Message.warning("请输入原始密码")),e},cancel:function(){this.psw="",this.oldpsw="",this.psw2="",this.show_psw=!1},change_pswok:function(){var e=this;if(this.checkForm()){var t={password:this.psw,old_password:this.oldpsw};this.$ajax("patch","/lander/changepassword/",t).then(function(t){console.log(t),"Change password successfully"==t.data.msg&&(e.$Message.warning("密码修改成功,请重新登录"),d["b"].removeStore("userInfo"),e.$router.push({name:"home"}))}).catch(function(t){t&&"Old password is not correct, please enter again"==t.data.msg&&(e.show_psw=!0,e.psw="",e.oldpsw="",e.psw2="",e.$Message.warning("原始密码错误，请重新输入"))})}}},computed:{},filters:{formatUserName:function(e){var t=e.indexOf("_"),n=e.charAt(0).toUpperCase()+e.slice(1);return n.slice(0,t+1)+n.charAt(t+1).toUpperCase()+n.slice(t+2)}},mounted:function(){var e=this;this.interval=Object(u["setInterval"])(function(){e.checkIsPay(),e.checkorder(),console.log("222")},6e4)},beforeDestroy:function(){this.interval&&Object(u["clearInterval"])(this.interval)}},p=h,f=(n("6027"),n("2877")),g=Object(f["a"])(p,o,a,!1,null,"ea84b6ee",null);t["default"]=g.exports}}]);